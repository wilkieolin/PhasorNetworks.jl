<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Metrics · PhasorNetworks.jl</title><meta name="title" content="Metrics · PhasorNetworks.jl"/><meta property="og:title" content="Metrics · PhasorNetworks.jl"/><meta property="twitter:title" content="Metrics · PhasorNetworks.jl"/><meta name="description" content="Documentation for PhasorNetworks.jl."/><meta property="og:description" content="Documentation for PhasorNetworks.jl."/><meta property="twitter:description" content="Documentation for PhasorNetworks.jl."/><meta property="og:url" content="https://wilkieolin.github.io/PhasorNetworks.jl/api/metrics/"/><meta property="twitter:url" content="https://wilkieolin.github.io/PhasorNetworks.jl/api/metrics/"/><link rel="canonical" href="https://wilkieolin.github.io/PhasorNetworks.jl/api/metrics/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PhasorNetworks.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../types/">Types</a></li><li><a class="tocitem" href="../network/">Networks</a></li><li><a class="tocitem" href="../spiking/">Spiking</a></li><li><a class="tocitem" href="../domains/">Domains</a></li><li><a class="tocitem" href="../vsa/">VSA</a></li><li><a class="tocitem" href="../gpu/">GPU</a></li><li class="is-active"><a class="tocitem" href>Metrics</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li class="is-active"><a href>Metrics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Metrics</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/wilkieolin/PhasorNetworks.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/main/docs/src/api/metrics.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Metrics-API"><a class="docs-heading-anchor" href="#Metrics-API">Metrics API</a><a id="Metrics-API-1"></a><a class="docs-heading-anchor-permalink" href="#Metrics-API" title="Permalink"></a></h1><p>Documentation for metrics and evaluation functions.</p><article><details class="docstring" open="true"><summary id="PhasorNetworks.OvR_matrices-Tuple{Any, Any, Real}"><a class="docstring-binding" href="#PhasorNetworks.OvR_matrices-Tuple{Any, Any, Real}"><code>PhasorNetworks.OvR_matrices</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">OvR_matrices(predictions, labels, threshold::Real)</code></pre><p>Compute One-vs-Rest confusion matrices for multi-class classification.</p><p><strong>Arguments</strong></p><ul><li><code>predictions</code>: Array of model predictions, with classes along first dimension</li><li><code>labels</code>: Array of true labels in one-hot format</li><li><code>threshold</code>: Classification threshold value</li></ul><p><strong>Returns</strong></p><ul><li>Array of confusion matrices, one for each class vs rest</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L180-L192">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.angular_mean-Tuple{AbstractArray}"><a class="docstring-binding" href="#PhasorNetworks.angular_mean-Tuple{AbstractArray}"><code>PhasorNetworks.angular_mean</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">angular_mean(phases::AbstractArray; dims) -&gt; AbstractArray</code></pre><p>Compute the circular mean of phase values along specified dimensions. Handles the circular nature of phases by converting to complex exponentials.</p><p><strong>Arguments</strong></p><ul><li><code>phases</code>: Array of phase values in [-1, 1] range</li><li><code>dims</code>: Dimensions along which to compute mean</li></ul><p><strong>Implementation</strong></p><ol><li>Converts phases to complex exponentials (e^(iπθ))</li><li>Computes arithmetic mean in complex plane</li><li>Converts back to phase via angle</li></ol><p><strong>Returns</strong></p><p>Phase values representing the circular mean along specified dimensions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L27-L44">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.arc_error-Tuple{Real}"><a class="docstring-binding" href="#PhasorNetworks.arc_error-Tuple{Real}"><code>PhasorNetworks.arc_error</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">arc_error(phase::Real) -&gt; Real
arc_error(phases::AbstractArray) -&gt; AbstractArray</code></pre><p>Compute the arc error for phase values, mapping phase differences to sinusoidal error. This provides a continuous, differentiable metric for phase differences.</p><p><strong>Arguments</strong></p><ul><li><code>phase</code>: Phase value in [-1, 1] range</li><li><code>phases</code>: Array of phase values</li></ul><p><strong>Returns</strong></p><p>Sine of the phase multiplied by π, producing smooth error measure in [-1, 1].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L5-L18">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.confusion_matrix-Tuple{Any, Any, Real}"><a class="docstring-binding" href="#PhasorNetworks.confusion_matrix-Tuple{Any, Any, Real}"><code>PhasorNetworks.confusion_matrix</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">confusion_matrix(sim, truth, threshold::Real) -&gt; Matrix{&lt;:Real}</code></pre><p>Compute binary confusion matrix given similarity scores and true labels.</p><p><strong>Arguments</strong></p><ul><li><code>sim</code>: Similarity or prediction scores</li><li><code>truth</code>: True labels (binary)</li><li><code>threshold</code>: Decision threshold for converting scores to predictions</li></ul><p><strong>Returns</strong></p><p>2×2 confusion matrix with format: [True Positive  False Positive] [False Negative True Negative]</p><p>Used by <a href="#PhasorNetworks.OvR_matrices-Tuple{Any, Any, Real}"><code>OvR_matrices</code></a> for multi-class evaluation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L270-L286">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.cor_realvals-Tuple{Any, Any}"><a class="docstring-binding" href="#PhasorNetworks.cor_realvals-Tuple{Any, Any}"><code>PhasorNetworks.cor_realvals</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">cor_realvals(x, y) -&gt; Real</code></pre><p>Compute correlation between two arrays, handling NaN values appropriately. Only considers positions where both arrays have real (non-NaN) values.</p><p><strong>Arguments</strong></p><ul><li><code>x, y</code>: Arrays of same size, potentially containing NaN values</li></ul><p><strong>Returns</strong></p><ul><li>Correlation coefficient between non-NaN values</li><li>Returns 0.0 if no valid pairs of values exist</li></ul><p>Used by <a href="#PhasorNetworks.cycle_correlation-Tuple{AbstractMatrix{&lt;:Real}, AbstractArray{&lt;:Real, 3}}"><code>cycle_correlation</code></a> and <a href="#PhasorNetworks.similarity_correlation-Tuple{AbstractMatrix{&lt;:Real}, AbstractArray{&lt;:Real, 3}}"><code>similarity_correlation</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L153-L167">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.cycle_correlation-Tuple{AbstractMatrix{&lt;:Real}, AbstractArray{&lt;:Real, 3}}"><a class="docstring-binding" href="#PhasorNetworks.cycle_correlation-Tuple{AbstractMatrix{&lt;:Real}, AbstractArray{&lt;:Real, 3}}"><code>PhasorNetworks.cycle_correlation</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">cycle_correlation(static_phases::Matrix{&lt;:Real}, dynamic_phases::Array{&lt;:Real,3}) -&gt; Vector{&lt;:Real}</code></pre><p>Compute correlation between static phase pattern and each cycle of dynamic phases.</p><p><strong>Arguments</strong></p><ul><li><code>static_phases</code>: Reference phase matrix (2D)</li><li><code>dynamic_phases</code>: Time-varying phase matrices (3D array with cycles as third dimension)</li></ul><p><strong>Returns</strong></p><p>Vector of correlation values, one for each cycle</p><p>See also: <a href="#PhasorNetworks.cor_realvals-Tuple{Any, Any}"><code>cor_realvals</code></a> for handling NaN values in correlation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L112-L125">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.cycle_sparsity-Tuple{Matrix{&lt;:Real}, Array{&lt;:Real, 3}}"><a class="docstring-binding" href="#PhasorNetworks.cycle_sparsity-Tuple{Matrix{&lt;:Real}, Array{&lt;:Real, 3}}"><code>PhasorNetworks.cycle_sparsity</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">cycle_sparsity(static_phases::Matrix{&lt;:Real}, dynamic_phases::Array{&lt;:Real,3}) -&gt; Vector{&lt;:Real}</code></pre><p>Calculate the sparsity (proportion of NaN values) for each cycle of dynamic phases.</p><p><strong>Arguments</strong></p><ul><li><code>static_phases</code>: Reference phase matrix (2D), used for size reference</li><li><code>dynamic_phases</code>: Time-varying phase matrices (3D array with cycles as third dimension)</li></ul><p><strong>Returns</strong></p><p>Vector of sparsity values (0.0-1.0) for each cycle, where:</p><ul><li>0.0 indicates no NaN values</li><li>1.0 indicates all values are NaN</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L132-L145">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.dense_onehot-Tuple{OneHotArrays.OneHotMatrix}"><a class="docstring-binding" href="#PhasorNetworks.dense_onehot-Tuple{OneHotArrays.OneHotMatrix}"><code>PhasorNetworks.dense_onehot</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">dense_onehot(x::OneHotMatrix) -&gt; Matrix{Float32}</code></pre><p>Convert a OneHotMatrix to a dense Float32 matrix. Useful for compatibility with neural network operations.</p><p><strong>Arguments</strong></p><ul><li><code>x</code>: OneHotMatrix representation</li></ul><p><strong>Returns</strong></p><p>Dense matrix with 1.0f0 values where x was true</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L254-L265">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.evaluate_accuracy-Tuple{AbstractArray, AbstractArray, Symbol}"><a class="docstring-binding" href="#PhasorNetworks.evaluate_accuracy-Tuple{AbstractArray, AbstractArray, Symbol}"><code>PhasorNetworks.evaluate_accuracy</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">evaluate_accuracy(values::AbstractArray, truth::AbstractArray, encoding::Symbol; reduce_dim::Int=1) -&gt; Tuple{Union{Int,Array},Int}
evaluate_accuracy(values::SpikingCall, truth::AbstractArray, encoding::Symbol; reduce_dim::Int=1) -&gt; Tuple{Union{Int,Array},Int}</code></pre><p>Evaluate classification accuracy for phase-based or spiking neural networks.</p><p><strong>Arguments</strong></p><ul><li><code>values</code>: Model predictions (phases, similarities, or spike trains)</li><li><code>truth</code>: Ground truth labels in one-hot format</li><li><code>encoding</code>: Encoding scheme (:similarity or :quadrature)</li><li><code>reduce_dim</code>: Dimension along which to compute accuracy (default: 1)</li></ul><p><strong>Implementation</strong></p><ol><li>Moves data to CPU if on GPU</li><li>Finds indices of true classes from one-hot truth</li><li>Converts predictions to class indices using specified encoding</li><li>Counts correct predictions</li><li>For spike trains, first converts to phases</li></ol><p><strong>Returns</strong></p><p>Tuple of (correct<em>predictions, total</em>samples) where:</p><ul><li><code>correct_predictions</code>: Number of correct predictions (or array for multiple evaluations)</li><li><code>total_samples</code>: Total number of samples evaluated</li></ul><p><strong>Notes</strong></p><ul><li>Handles both direct predictions and spike train inputs</li><li>Supports different dimensionality between predictions and truth</li><li>Automatically handles GPU/CPU device placement</li></ul><p>See also: <a href="#PhasorNetworks.predict"><code>predict</code></a> for the underlying prediction mechanism</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L489-L519">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.evaluate_loss"><a class="docstring-binding" href="#PhasorNetworks.evaluate_loss"><code>PhasorNetworks.evaluate_loss</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">evaluate_loss(predictions::AbstractArray, truth::AbstractArray, encoding::Symbol = :similarity; reduce_dim::Int = 1) -&gt; AbstractArray
evaluate_loss(predictions::SpikingCall, truth::AbstractArray, encoding::Symbol = :similarity; reduce_dim::Int = 1) -&gt; AbstractArray</code></pre><p>Evaluate loss between predictions and truth values using specified encoding scheme.</p><p><strong>Arguments</strong></p><ul><li><code>predictions</code>: Model predictions (phases or spike trains)</li><li><code>truth</code>: Target values</li><li><code>encoding</code>: Encoding scheme (:similarity or :quadrature)</li><li><code>reduce_dim</code>: Dimension along which to compute loss (default: 1)</li></ul><p><strong>Encoding Schemes</strong></p><ul><li><code>:similarity</code>: Uses <a href="#PhasorNetworks.similarity_loss-Tuple{AbstractArray, AbstractArray}"><code>similarity_loss</code></a></li><li><code>:quadrature</code>: Uses <a href="#PhasorNetworks.quadrature_loss-Tuple{AbstractArray, AbstractArray}"><code>quadrature_loss</code></a></li></ul><p><strong>Implementation</strong></p><ol><li>Selects appropriate loss function based on encoding</li><li>Handles dimension mismatches between predictions and truth</li><li>For spike trains, converts to phases before evaluation</li></ol><p>Returns loss values appropriate for the chosen encoding scheme.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L348-L370">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.exp_score-Tuple{AbstractArray}"><a class="docstring-binding" href="#PhasorNetworks.exp_score-Tuple{AbstractArray}"><code>PhasorNetworks.exp_score</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">exp_score(similarity::AbstractArray; scale::Real = 3.0f0) -&gt; AbstractArray</code></pre><p>Convert similarity values to exponential scores, emphasizing differences. Useful for converting similarity metrics to loss-like values.</p><p><strong>Arguments</strong></p><ul><li><code>similarity</code>: Array of similarity values in [0, 1] range</li><li><code>scale</code>: Scaling factor for exponential transformation (default: 3.0)</li></ul><p><strong>Returns</strong></p><p>Transformed scores where:</p><ul><li>Perfect similarity (1.0) maps to 0.0</li><li>Lower similarities produce exponentially larger positive values</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L52-L66">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.interpolate_roc-Tuple{Any}"><a class="docstring-binding" href="#PhasorNetworks.interpolate_roc-Tuple{Any}"><code>PhasorNetworks.interpolate_roc</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">interpolate_roc(roc) -&gt; Function</code></pre><p>Create an interpolated function from ROC curve points. Useful for smooth ROC curve visualization and AUC calculation.</p><p><strong>Arguments</strong></p><ul><li><code>roc</code>: Tuple of (TPR, FPR) vectors from <a href="#PhasorNetworks.tpr_fpr"><code>tpr_fpr</code></a></li></ul><p><strong>Returns</strong></p><p>Interpolation function mapping FPR to TPR values</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L236-L247">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.loss_and_accuracy-NTuple{5, Any}"><a class="docstring-binding" href="#PhasorNetworks.loss_and_accuracy-NTuple{5, Any}"><code>PhasorNetworks.loss_and_accuracy</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">loss_and_accuracy(data_loader, model, ps, st, args; reduce_dim::Int=1, encoding::Symbol = :codebook) -&gt; Tuple{Real,Real}</code></pre><p>Evaluate model loss and accuracy on a dataset.</p><p><strong>Arguments</strong></p><ul><li><code>data_loader</code>: Iterator providing (input, target) pairs</li><li><code>model</code>: Neural network model</li><li><code>ps</code>: Model parameters</li><li><code>st</code>: Model state</li><li><code>args</code>: Configuration arguments (including use_cuda)</li><li><code>reduce_dim</code>: Dimension for reduction operations</li><li><code>encoding</code>: Phase encoding scheme (:codebook or :quadrature)</li></ul><p><strong>Returns</strong></p><p>Tuple of (average_loss, accuracy)</p><p><strong>Notes</strong></p><p>Automatically handles GPU/CPU device placement based on args.use_cuda</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L544-L563">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.predict"><a class="docstring-binding" href="#PhasorNetworks.predict"><code>PhasorNetworks.predict</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">predict(predictions::AbstractArray, encoding::Symbol = :similarity; reduce_dim=1) -&gt; AbstractArray
predict(predictions::SpikingCall, encoding::Symbol = :similarity; reduce_dim::Int=1) -&gt; AbstractArray</code></pre><p>Convert model outputs to class predictions using specified encoding scheme.</p><p><strong>Arguments</strong></p><ul><li><code>predictions</code>: Model outputs (phases, similarities, or spike trains)</li><li><code>encoding</code>: Encoding scheme (:similarity or :quadrature)</li><li><code>reduce_dim</code>: Dimension along which to make predictions</li></ul><p><strong>Encoding Schemes</strong></p><ul><li><code>:similarity</code>: Uses <a href="#PhasorNetworks.predict_similarity-Tuple{AbstractArray}"><code>predict_similarity</code></a></li><li><code>:quadrature</code>: Uses <a href="#PhasorNetworks.predict_quadrature-Tuple{AbstractArray}"><code>predict_quadrature</code></a></li></ul><p>For spike trains, automatically converts to phases before prediction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L456-L472">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.predict_quadrature-Tuple{AbstractArray}"><a class="docstring-binding" href="#PhasorNetworks.predict_quadrature-Tuple{AbstractArray}"><code>PhasorNetworks.predict_quadrature</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">predict_quadrature(phases::AbstractArray; dim::Int=1) -&gt; AbstractArray</code></pre><p>Convert phase values to class predictions using quadrature encoding. Finds classes by minimum distance to target phase (0.5).</p><p><strong>Arguments</strong></p><ul><li><code>phases</code>: Array of phase values</li><li><code>dim</code>: Dimension along which to find predictions (default: 1)</li></ul><p><strong>Implementation</strong></p><p>Automatically handles GPU arrays by moving to CPU for argmin operation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L408-L420">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.predict_similarity-Tuple{AbstractArray}"><a class="docstring-binding" href="#PhasorNetworks.predict_similarity-Tuple{AbstractArray}"><code>PhasorNetworks.predict_similarity</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">predict_similarity(sims::AbstractArray; dim::Int=1) -&gt; AbstractArray</code></pre><p>Convert similarity values to class predictions by taking argmax. Used for similarity-based classification.</p><p><strong>Arguments</strong></p><ul><li><code>sims</code>: Array of similarity values</li><li><code>dim</code>: Dimension along which to find maximum (default: 1)</li></ul><p><strong>Implementation</strong></p><p>Automatically handles GPU arrays by moving to CPU for argmax operation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L432-L444">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.quadrature_loss-Tuple{AbstractArray, AbstractArray}"><a class="docstring-binding" href="#PhasorNetworks.quadrature_loss-Tuple{AbstractArray, AbstractArray}"><code>PhasorNetworks.quadrature_loss</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">quadrature_loss(phases::AbstractArray, truth::AbstractArray; dim::Int = 1) -&gt; AbstractArray</code></pre><p>Compute loss based on quadrature phase encoding relative to target values.</p><p><strong>Arguments</strong></p><ul><li><code>phases</code>: Array of phase values</li><li><code>truth</code>: Target values (binary/one-hot encoded)</li><li><code>dim</code>: Dimension along which to compute similarity (default: 1)</li></ul><p><strong>Implementation</strong></p><ol><li>Scales truth values to target phases (0.5 * truth)</li><li>Computes similarity between phases and targets</li><li>Returns dissimilarity (1 - similarity)</li></ol><p>Used for phase-based classification tasks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L298-L314">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.similarity_correlation-Tuple{AbstractMatrix{&lt;:Real}, AbstractArray{&lt;:Real, 3}}"><a class="docstring-binding" href="#PhasorNetworks.similarity_correlation-Tuple{AbstractMatrix{&lt;:Real}, AbstractArray{&lt;:Real, 3}}"><code>PhasorNetworks.similarity_correlation</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">similarity_correlation(static_similarity::Matrix{&lt;:Real}, dynamic_similarity::Array{&lt;:Real,3}) -&gt; Vector{&lt;:Real}</code></pre><p>Compute correlation between static similarity matrix and each time step of dynamic similarities.</p><p><strong>Arguments</strong></p><ul><li><code>static_similarity</code>: Reference similarity matrix (2D)</li><li><code>dynamic_similarity</code>: Time-varying similarity matrices (3D array with time as third dimension)</li></ul><p><strong>Returns</strong></p><p>Vector of correlation values, one for each time step</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L94-L105">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.similarity_loss-Tuple{AbstractArray, AbstractArray}"><a class="docstring-binding" href="#PhasorNetworks.similarity_loss-Tuple{AbstractArray, AbstractArray}"><code>PhasorNetworks.similarity_loss</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">similarity_loss(similarities::AbstractArray, truth::AbstractArray; dim::Int = 1) -&gt; AbstractArray</code></pre><p>Compute a smooth loss function based on phase similarities and truth values.</p><p><strong>Arguments</strong></p><ul><li><code>similarities</code>: Array of similarity values</li><li><code>truth</code>: Target values (binary/one-hot encoded)</li><li><code>dim</code>: Dimension along which to compute loss (default: 1)</li></ul><p><strong>Implementation</strong></p><ol><li>Computes absolute difference from perfect similarity (1.0)</li><li>Weights differences by truth values</li><li>Applies smooth sin² transformation for stable gradients</li></ol><p>Returns a loss that:</p><ul><li>Is 0 for perfect similarity with correct class</li><li>Grows smoothly for increasing dissimilarity</li><li>Is properly scaled for gradient-based optimization</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L321-L340">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.spiking_loss_and_accuracy-NTuple{5, Any}"><a class="docstring-binding" href="#PhasorNetworks.spiking_loss_and_accuracy-NTuple{5, Any}"><code>PhasorNetworks.spiking_loss_and_accuracy</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">spiking_loss_and_accuracy(data_loader, model, ps, st, args; reduce_dim::Int=1, encoding::Symbol = :codebook, repeats::Int) -&gt; Tuple{Array,Array}</code></pre><p>Evaluate spiking neural network loss and accuracy over multiple repeats.</p><p><strong>Arguments</strong></p><ul><li><code>data_loader</code>: Iterator providing (input, target) pairs</li><li><code>model</code>: Spiking neural network model</li><li><code>ps</code>: Model parameters</li><li><code>st</code>: Model state</li><li><code>args</code>: Configuration arguments</li><li><code>reduce_dim</code>: Dimension for reduction operations</li><li><code>encoding</code>: Phase encoding scheme</li><li><code>repeats</code>: Number of evaluation repeats</li></ul><p><strong>Returns</strong></p><p>Tuple of (losses, accuracies) where:</p><ul><li>losses: Array of shape (1, repeats)</li><li>accuracies: Array of length repeats</li></ul><p>Useful for assessing the reliability of spiking network performance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L592-L613">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.tpr_fpr"><a class="docstring-binding" href="#PhasorNetworks.tpr_fpr"><code>PhasorNetworks.tpr_fpr</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">tpr_fpr(prediction, labels, points::Int = 201, epsilon::Real = 0.01f0)</code></pre><p>Calculate True Positive Rate (TPR) and False Positive Rate (FPR) curves for ROC analysis.</p><p><strong>Arguments</strong></p><ul><li><code>prediction</code>: Model predictions array</li><li><code>labels</code>: True labels array</li><li><code>points</code>: Number of threshold points to evaluate (default: 201)</li><li><code>epsilon</code>: Small value to prevent division by zero (default: 0.01f0)</li></ul><p><strong>Returns</strong></p><ul><li>Tuple of (TPR, FPR) arrays for ROC curve plotting</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L199-L212">source</a></section></details></article><article><details class="docstring" open="true"><summary id="PhasorNetworks.z_score-Tuple{AbstractArray}"><a class="docstring-binding" href="#PhasorNetworks.z_score-Tuple{AbstractArray}"><code>PhasorNetworks.z_score</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">z_score(phases::AbstractArray) -&gt; AbstractArray</code></pre><p>Compute a z-score like metric for phase values using inverse hyperbolic tangent. Provides a measure of how far phases deviate from the midpoint (0.5).</p><p><strong>Arguments</strong></p><ul><li><code>phases</code>: Array of phase values in [-1, 1] range</li></ul><p><strong>Implementation</strong></p><ol><li>Centers phases around 0 by subtracting 0.5</li><li>Remaps to standard phase range</li><li>Applies inverse hyperbolic tangent and takes absolute value</li></ol><p><strong>Returns</strong></p><p>Non-negative scores that grow larger for phases further from 0.5</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/wilkieolin/PhasorNetworks.jl/blob/86c0619504cc47d48544f03b8c7952dd9b9bff79/src/metrics.jl#L71-L87">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gpu/">« GPU</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 26 November 2025 20:23">Wednesday 26 November 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
